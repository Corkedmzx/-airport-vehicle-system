# 前后端API接口联调测试指南

## 测试环境准备

### 1. 启动后端服务

```bash
cd /workspace/airport-vehicle-system/backend

# 启动SpringBoot应用
mvn spring-boot:run
```

确保后端在 http://localhost:8080 启动成功，访问 http://localhost:8080/api/swagger-ui.html 查看API文档。

### 2. 启动前端应用

```bash
cd /workspace/airport-vehicle-system/frontend

# 安装依赖 (如未安装)
npm install

# 启动开发服务器
npm run dev
```

前端将在 http://localhost:3000 启动。

## API接口测试

### 1. 认证接口测试

#### 1.1 用户登录测试
- **接口**: POST /api/auth/login
- **请求参数**:
```json
{
  "username": "admin",
  "password": "admin123"
}
```

**前端测试步骤**:
1. 访问 http://localhost:3000/login
2. 输入用户名: admin
3. 输入密码: admin123
4. 点击"登录"按钮
5. 验证跳转到Dashboard页面

**预期结果**:
- 登录成功，存储JWT token到localStorage
- 自动跳转到系统主界面
- 显示欢迎信息和用户信息

#### 1.2 用户注册测试
- **接口**: POST /api/auth/register
- **请求参数**:
```json
{
  "username": "testuser",
  "password": "test123",
  "email": "test@example.com",
  "realName": "测试用户"
}
```

**前端测试步骤**:
1. 在登录页面点击"注册"
2. 填写注册信息
3. 提交注册表单

### 2. 车辆管理接口测试

#### 2.1 获取车辆列表
- **接口**: GET /api/vehicles
- **测试步骤**:
1. 登录后进入车辆管理页面
2. 验证车辆列表正常显示
3. 测试分页功能

#### 2.2 添加车辆
- **接口**: POST /api/vehicles
- **请求参数**:
```json
{
  "vehicleNumber": "机场001",
  "vehicleType": "大巴车",
  "driverName": "张师傅",
  "status": "idle",
  "currentLocation": {
    "latitude": 40.7128,
    "longitude": -74.0060
  }
}
```

**前端测试步骤**:
1. 点击"新增车辆"按钮
2. 填写车辆信息表单
3. 提交表单
4. 验证新增成功

#### 2.3 编辑车辆信息
- **接口**: PUT /api/vehicles/{id}
- **测试步骤**:
1. 在车辆列表中点击编辑按钮
2. 修改车辆信息
3. 保存更改
4. 验证更新成功

#### 2.4 删除车辆
- **接口**: DELETE /api/vehicles/{id}
- **测试步骤**:
1. 选择要删除的车辆
2. 确认删除操作
3. 验证车辆从列表中移除

### 3. 调度任务接口测试

#### 3.1 获取任务列表
- **接口**: GET /api/dispatch-tasks
- **测试步骤**:
1. 进入调度任务页面
2. 验证任务列表正常显示
3. 测试状态筛选功能

#### 3.2 创建调度任务
- **接口**: POST /api/dispatch-tasks
- **请求参数**:
```json
{
  "taskName": "接送旅客",
  "vehicleId": 1,
  "driverId": 1,
  "priority": "normal",
  "estimatedDuration": 60,
  "startLocation": {
    "latitude": 40.7589,
    "longitude": -73.9851
  },
  "endLocation": {
    "latitude": 40.7505,
    "longitude": -73.9934
  },
  "taskDescription": "从航站楼到停车场接送旅客"
}
```

**前端测试步骤**:
1. 点击"新建任务"按钮
2. 填写任务信息
3. 选择车辆和司机
4. 提交任务
5. 验证任务创建成功

#### 3.3 任务状态更新
- **接口**: PATCH /api/dispatch-tasks/{id}/status
- **请求参数**:
```json
{
  "status": "in_progress"
}
```

**测试步骤**:
1. 选择待处理任务
2. 点击"开始任务"
3. 验证状态更新

### 4. 数据统计接口测试

#### 4.1 获取统计概览
- **接口**: GET /api/statistics/overview
- **测试步骤**:
1. 进入Dashboard页面
2. 验证统计卡片显示
3. 检查数据刷新功能

#### 4.2 车辆利用率统计
- **接口**: GET /api/statistics/vehicle-utilization
- **测试步骤**:
1. 进入统计页面
2. 查看车辆利用率图表
3. 测试时间段筛选

#### 4.3 任务完成统计
- **接口**: GET /api/statistics/task-completion
- **测试步骤**:
1. 查看任务完成率统计
2. 验证图表数据正确性

## 前端功能测试

### 1. 用户界面测试

#### 1.1 登录页面
- [ ] 页面布局正确显示
- [ ] 表单验证正常工作
- [ ] 登录成功后跳转
- [ ] 错误信息正确显示
- [ ] 注册功能正常

#### 1.2 主界面布局
- [ ] 侧边导航栏正常显示
- [ ] 顶部用户信息显示
- [ ] 菜单路由跳转正常
- [ ] 响应式布局适配

### 2. 数据展示测试

#### 2.1 列表页面
- [ ] 数据表格正常显示
- [ ] 分页功能正常
- [ ] 搜索功能正常
- [ ] 排序功能正常
- [ ] 筛选功能正常

#### 2.2 图表展示
- [ ] ECharts图表正常渲染
- [ ] 数据更新实时反映
- [ ] 图表交互功能正常
- [ ] 响应式图表适配

### 3. 交互功能测试

#### 3.1 CRUD操作
- [ ] 新增功能正常
- [ ] 编辑功能正常
- [ ] 删除功能正常
- [ ] 批量操作正常
- [ ] 数据验证正常

#### 3.2 实时更新
- [ ] 车辆位置实时更新
- [ ] 任务状态实时更新
- [ ] 统计数据实时刷新
- [ ] WebSocket连接正常 (如实现)

## 性能测试

### 1. 页面加载测试
- [ ] 首页加载时间 < 3秒
- [ ] 列表页面加载时间 < 2秒
- [ ] 图表页面加载时间 < 5秒
- [ ] 图片资源加载正常

### 2. API响应时间测试
- [ ] 登录接口响应时间 < 1秒
- [ ] 列表查询接口响应时间 < 2秒
- [ ] 统计数据接口响应时间 < 3秒
- [ ] 文件上传接口响应时间 < 10秒

### 3. 并发测试
- [ ] 10用户并发登录正常
- [ ] 100用户并发查询正常
- [ ] 系统资源使用合理
- [ ] 无内存泄漏现象

## 兼容性测试

### 1. 浏览器兼容性
- [ ] Chrome 90+ 正常运行
- [ ] Firefox 88+ 正常运行
- [ ] Safari 14+ 正常运行
- [ ] Edge 90+ 正常运行

### 2. 设备兼容性
- [ ] 桌面端 (1920x1080) 正常显示
- [ ] 平板端 (768x1024) 正常显示
- [ ] 移动端 (375x667) 正常显示
- [ ] 不同分辨率适配正常

## 安全测试

### 1. 身份认证测试
- [ ] 未登录用户无法访问受保护页面
- [ ] JWT token过期处理正常
- [ ] 登录状态保持正常
- [ ] 登出功能正常

### 2. 数据安全测试
- [ ] 敏感数据传输加密
- [ ] SQL注入防护有效
- [ ] XSS攻击防护有效
- [ ] CSRF攻击防护有效

## 错误处理测试

### 1. 网络异常测试
- [ ] 网络断开处理正常
- [ ] 服务器错误处理正常
- [ ] 超时处理正常
- [ ] 重试机制正常

### 2. 数据异常测试
- [ ] 空数据处理正常
- [ ] 数据格式错误处理正常
- [ ] 权限不足处理正常
- [ ] 业务逻辑错误处理正常

## 测试记录模板

### 接口测试记录

| 测试项目 | 请求方法 | 请求URL | 状态码 | 响应时间 | 测试结果 | 备注 |
|---------|----------|---------|--------|----------|----------|------|
| 用户登录 | POST | /api/auth/login | 200 | 500ms | ✅ 通过 | |
| 获取车辆列表 | GET | /api/vehicles | 200 | 800ms | ✅ 通过 | |
| 新增车辆 | POST | /api/vehicles | 201 | 1200ms | ✅ 通过 | |
| 更新车辆 | PUT | /api/vehicles/1 | 200 | 600ms | ✅ 通过 | |
| 删除车辆 | DELETE | /api/vehicles/1 | 204 | 400ms | ✅ 通过 | |

### 功能测试记录

| 功能模块 | 测试用例 | 预期结果 | 实际结果 | 状态 | 问题描述 |
|---------|----------|----------|----------|------|----------|
| 用户登录 | 正确用户名密码登录 | 跳转到Dashboard | 跳转成功 | ✅ 通过 | |
| 用户登录 | 错误用户名密码 | 显示错误信息 | 显示"用户名或密码错误" | ✅ 通过 | |
| 车辆管理 | 新增车辆 | 车辆列表显示新车辆 | 车辆成功添加 | ✅ 通过 | |
| 任务调度 | 创建调度任务 | 任务状态为待处理 | 任务创建成功 | ✅ 通过 | |

## 常见问题解决

### 1. CORS跨域问题
**问题**: 前端调用后端接口出现CORS错误
**解决**: 检查后端CORS配置，确保允许前端域名访问

```java
@CrossOrigin(origins = "http://localhost:3000")
```

### 2. 认证问题
**问题**: 前端无法访问需要认证的接口
**解决**: 确保JWT token正确传递，检查token有效性

### 3. 数据格式问题
**问题**: 前端接收的数据格式与预期不符
**解决**: 检查API响应格式，确保前后端数据结构一致

### 4. 图表显示问题
**问题**: ECharts图表不显示或显示异常
**解决**: 检查数据格式，确保图表组件正确初始化

## 测试完成检查清单

- [ ] 所有API接口测试通过
- [ ] 前端功能测试通过
- [ ] 性能测试达标
- [ ] 兼容性测试通过
- [ ] 安全测试通过
- [ ] 错误处理测试通过
- [ ] 用户体验测试通过
- [ ] 数据一致性验证通过

**测试完成后，生成测试报告并归档。**

---

**测试环境地址**:
- 前端: http://localhost:3000
- 后端API: http://localhost:8080/api
- API文档: http://localhost:8080/api/swagger-ui.html
